import{r as s}from"./vendor-CqPHgGp8.js";import{u as d}from"./UrlFactory-Fbw8L19P.js";const c="";async function y(){return(await fetch(`${c}/auth/status`,{credentials:"include"})).json()}async function p(t,e){const r=await fetch(`${c}/auth/login`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({email:t,password:e})});if(!r.ok)throw new Error((await r.json()).error||"Login failed");return r.json()}async function m(t,e,r){const a=await fetch(`${c}/auth/register`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({email:t,password:e,name:r})});if(!a.ok)throw new Error((await a.json()).error||"Registration failed");return a.json()}async function k(){return(await fetch(`${c}/auth/logout`,{method:"POST",credentials:"include"})).json()}function O(){sessionStorage.setItem("auth_redirect",window.location.pathname),window.location.href=d.getOAuthGoogleUrl()}function A(){sessionStorage.setItem("auth_redirect",window.location.pathname),window.location.href=d.getOAuthLinkedInUrl()}async function E(t){const e=await fetch(`${c}/api/me/unlink-provider`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({provider:t})});if(!e.ok)throw new Error((await e.json()).error||"Failed to unlink provider");return e.json()}function T(){const[t,e]=s.useState(null),[r,a]=s.useState(!0),l=s.useCallback(async()=>{try{const n=await y();n.loggedIn?e(n.user):e(null)}catch(n){console.error("Auth check failed:",n),e(null)}finally{a(!1)}},[]);s.useEffect(()=>{l()},[l]);const h=async(n,u)=>{try{const o=await p(n,u);return o.ok&&o.user?(e(o.user),!0):!1}catch(o){return console.error("Login failed:",o),!1}},f=async(n,u,o)=>{try{const i=await m(n,u,o);return i.ok&&i.user?(e(i.user),!0):!1}catch(i){return console.error("Registration failed:",i),!1}},g=async()=>{try{await k(),e(null),window.location.href="/"}catch(n){console.error("Logout failed:",n)}},w=s.useCallback(async()=>{await l()},[l]);return{user:t,loading:r,login:h,register:f,logout:g,refreshAuth:w,isAuthenticated:!!t,isAdmin:(t==null?void 0:t.role)==="ADMIN",isContributor:(t==null?void 0:t.role)==="CONTRIBUTOR",isMember:(t==null?void 0:t.role)==="MEMBER"}}export{A as a,E as b,O as l,T as u};
//# sourceMappingURL=useSimpleAuth-B-RaJJcg.js.map
